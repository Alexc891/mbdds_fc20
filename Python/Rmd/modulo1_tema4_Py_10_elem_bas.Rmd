
## 2.3. Elementos básicos de Python

__[Abre en Colab](https://colab.research.google.com/github/griu/mbdds_fc20/blob/master/Python/modulo1_tema4_Py_10_elem_bas.ipynb)__

Aunque se presuponen unos conocimientos iniciales de Python, a continuación, se hace un repaso de Python, Anaconda y notebooks de Jupyter-Colab. El objetivo es reforzar aquellos elementos más orientados al análisis de datos.

#### INTERFAZ DE USUARIO

Python se puede ejecutar de forma interactiva des de consola de texto. Para abrir la consola, ejecutar el comando Python desde un terminal Windows o Linux. El temario utiliza notebooks ejecutados des de Jupyter y/o Colab. 

Prueba a ejecutar la siguiente línea directamente en este notebook.

```{python}
6 / (4 - 1.5)
```

> **Recuerda**: Para editar una celda del notebook, aprieta `Enter`. Para ejecutarla,  `Ctrl+Enter` (sólo ejecuta), o bien, `Mayús+Enter` (ejecuta y avanza celda).  

#### FICHEROS *.py

Una forma habitual de programar en Python es mediante ficheros de texto con extensión `.py`. Existen múltiples entornos para estos ficheros: Spyder (parecido a RStudio), PyCharm, Visual Studio Code o cualquier editor de texto como Notepad++.

Este tipo de ficheros se utilizan habitualmente para generar librerías de funciones y ejecutar desarrollo productivo de aplicaciones en Python.

#### NOTEBOOKS JUPYTER (*.ipynb)

Los notebooks, como éste que estás leyendo, son la solución de la comunidad de SciPy para la programación interactiva. El proyecto nació con el nombre [IPython](https://ipython.org) (o Python interactivo) y actualmente se orquestra en el paraguas de la plataforma [Jupyter](https://jupyter.org/). Jupyter permite ejecutar de forma interactiva docenas de lenguajes como Python, R...

Los notebooks, al igual que Rmardown, permiten combinar texto en formato Markdown (lenguaje de marcas ligero), con código con resultados en forma de texto o gráficos. Esta forma de funcionar resulta óptima para el análisis de datos y la formación.

Su uso se ha extendido de la mano del proyecto [Anaconda](https://www.anaconda.com/), la mayor plataforma de gestión de librerías open source enfocadas a la computación científica.

Para iniciar el entorno Jupyter sigue la guía del [Anexo: README de Python](modulo1_tema4_Py_60_anexo.ipynb) apartado "PREPARACIÓN ENTORNO LOCAL-JUPYTER (OPCIONAL)".

##### COLABORATORY o COLAB

Actualmente la comunidad de Python cuenta con la plataforma [Colaboratory o Colab](https://colab.research.google.com) que es un entorno libre para ejecutar notebooks Jupyter y almacenarlos en Google Drive. Este entorno sólo permite abrir ficheros .ipynb (no .py), pero facilita en gran medida su uso para desarrollar formación.

Puedes abrir los notebooks de este tema con Colab clicando en: [<span style="color:white;background-color:#1E90FF;font-size: 110%;border:2px solid #4682B4;text-decoration:underline">|  Abre en Colab  |</span>](https://colab.research.google.com/github/griu/mbdds_fc20/blob/master/Python/modulo1_tema4_Py_10_elem_bas.ipynb)



En la parte superior de los notebooks, encontrarás un script que inicializa el entorno Colab con las versiones de los paquetes de Python correctas y descarga el repositorio Github con el material del curso.  

##### ACTIVIDAD GUIADA 2.1.

Crea tu primer notebook. En Jupyter/Colab, accede al menú `File > New Notebook`. 

> En Jupyter, selecciona el Kernel `mbdds_rpy20` que has creado como se indica en el [Anexo: README de Python](modulo1_tema4_Py_60_anexo.ipynb).

Inserta el siguiente código Python y ejecútalo:

```
print("Hello Wold!")
```

Guarda el documento con el nombre `21_actividad`.

##### EDITAR NOTEBOOKS JUPYTER

Un notebook está compuesto por un conjunto de casillas que pueden ser de distinto tipo:

- *Code*: Código Python que se puede ejecutar interactivamente y puede tener un salida o output.
- *Markdown*: Inserta texto con este formato. No tiene output.

Una casilla, puede tener dos modos:

- Edición: Aprieta `Enter` o doble clic. Puedes modificar su contenido Python o Markdown
- Visión: Tecla `Esc` o clic barra izquierda (en Jupyter). Selecciona una o varias casillas con el ratón o con las teclas `Mayús + Cursos`.

Para mostrar una casilla Markdown en formato impresión (sin marcas), ejecútala del mismo modo que si fuera código:
  - Sólo ejecutar: `Ctrl+Enter`.
  - Ejecutar y avanzar casilla: Botón `Run`, o bien, `Mayús+Enter`.
  

###### ATAJOS DE TECLADO

Puedes gestionar las celdas des del teclado en el modo de Visión (**tecla`Esc`**):

- Cambiar tipo celda: 
  - Modo Markdown: Tecla `M`, `Ctr+M+M` (Colab).
  - Modo Code: Tecla `Y`, `Ctr+M+Y` (Colab).
- Insertar celdas:
  - Antes: Tecla `A`, `Ctr+M+A` (Colab).
  - Después: Tecla `B`, `Ctr+M+B` (Colab).
- Copiar, pegar, desplazar arriba, abajo...

###### MARKDOWN

- **Parágrafo de texto**: Deja  una línea en blanco (`Enter`) antes y después de un parágrafo de texto.
- **Encabezados**: Utiliza # seguido de espacio en blanco para los títulos de las secciones:

```
# TITULO NIVEL 1
## TITULO NIVEL 2
...
```

Deja también una línea en blanco (`Enter`) antes y después del título.

- **Emphasis**: Negrita con `**string**` . Cursiva con `*string*`.
- **Código látex**:  ```$x^2$```. $x^2$
- **Fuente ancho fijo**:  \`texto\` (usa tilde abierta o con orientación izquierda).
- **Bloque de código (sin que se ejecute)**:  Tres abiertas, código (nueva línea), tres tildes abiertas. Ejemplo: 

\`\`\`
```
Soy codigo1
Soy código2 
```
\`\`\`

- **Línea en blanco**: Usa una líena nueva con dos espacios o `<br>`.
- **Lista de puntos**: Al inicio de línea, usa guion `-` seguido de espacio y texto. Para una sublista de puntos pon tres espacios o tabulado y guion. Puedes usar también asterisco.
- **Lista numerada**: Al inicio, pon `1. ` seguido de espacio y texto. No es necesario cambiar el `1.` en cada nueva línea.
- **Link externo**: `[texto enlace](http://url)`
- **Link interno**: Crea un ID con html `<a id="seccion_ID"></a>` antes de la sección. Ahora, para enlazar con la sección, utiliza `[titulo sección](#seccion_ID)`.
- **Imagen**: Arrastrar y soltar en la celda markdown. También con `![texto alternativo](url imagen o ruta del a imagen)`, o también, ` <img src="url imagen o ruta del a imagen" alt="texto alternativo" title="texto descriptivo" />` .
- **Sangrado (Indented)**: Al incio de línea, usa símbolo `> ` seguido de espacio y texto. Ejemplo:

> Texto sangrado

- **Línea horizontal**: Tres asteriscos al inicio de línea, `***` .
- **Colores**: Usa `<font color=blue|red|green|pink|yellow>Texto</font>` .

###### AYUDA DES DEL NOTEBOOK

En Python se pide ayuda de un comando con:

```{python}
help(len)
```

En Jupyter, ejecuta `?comando` para que se abra un menú contextual de ayuda.

```
?len
```

También con el tabulador tea ayuda a autocompletar código, ver opciones, parámetros... 

###### COMANDOS MÁGICOS

Los comandos mágicos, aumentan las capacidades interactivas de los notebooks. Son de uso común:

Ejecutar script .py

```
%run holaMundo.py
```

```
## Hello World!
```

Historial de comandos ejecutados.

```
# vemos los primerso 3:
%history 1-3
```

```
## if 'google.colab' in str(get_ipython()):
##     !git clone https://github.com/griu/mbdds_fc20.git /content/mbdds_fc20
##     !git -C /content/mbdds_fc20 pull
##     %cd /content/mbdds_fc20/Python
##     !python -m pip install -r requirementsColab.txt
6 / (4 - 1.5)
## help(len)
```

Cambiar de directorio de trabajo.

```
%cd nueva_ruta
```

Tiempo de ejecución de una línea.

```
%time L = [n ** 2 for n in range(1000)]
```

```
## CPU times: user 566 µs, sys: 43 µs, total: 609 µs
## Wall time: 616 µs
```

De toda una celda

```
%%time
L1 = [n ** 2 for n in range(1000)]
L2 = [n ** 2 for n in range(1000)]
L3 = [n ** 2 for n in range(1000)]
```

```
## CPU times: user 1.99 ms, sys: 0 ns, total: 1.99 ms
## Wall time: 2 ms
```

###### COMANDOS SHELL

Los comandos de sistema se pueden ejecutar con `!comando`

```
!dir
```

```
## holaMundo.py			      modulo1_tema4_Py_40_contr_flujo.ipynb
## modulo1_tema4_Py_00_indice.ipynb      modulo1_tema4_Py_50_gest_dat.ipynb
## modulo1_tema4_Py_10_elem_bas.ipynb    modulo1_tema4_Py_60_anexo.ipynb
## modulo1_tema4_Py_20_matplotlib.ipynb  modulo1_tema4_Py.ipynb
## modulo1_tema4_Py_30_colec_obj.ipynb   README.md
## modulo1_tema4_Py_31_numpy.ipynb       requirementsColab.txt
## modulo1_tema4_Py_32_pandas.ipynb      www
```

#### FUNCIONES

Para definir la función valor absoluto: 

```{python}
def valor_absoluto(num):
    """devuelve el valor absoluto"""

    if num >= 0:
        return num
    else:
        return -num
```

- Se inicia la definción con `def`, seguido del nombre de la función
- A continuación los parámetros entre paréntesis y `:` 
  - Admite definir valores por defecto 
- El texto sirve como ayuda cuando se llama a ?valor_absoluto
- El cuerpo del código con sangrado
- Puede devolver un objeto añadiendo `return objecto`
- Si se quiere devolver valores por pantalla hay que usar print

Para llamar a la función.

```{python}
valor_absoluto(-6)
```

#### PAQUETES

El indexador de paquetes de Python es **PyPI**. igual que **CRAN** en R. Actualmente indexa más de 235.000 librearías.

Para instalarlos hay distintos métodos. El más general es mediante `pip` desde Shell.

```
pip install nombre_paquete
```

> **Sabías que**: Anaconda tiene su propio gestor de paquetes llamado `conda`. Funciona de forma similar a `pip`. Además `conda`, aporta la capacidad de gestionar *Environments*, que a su vez, permiten fijar un conjunto de versiones de paquetes de Python. Los *Environments* facilitan reproducir en otras máquinas todo el entorno de ejecución y la replicabilidad de los desarrollos. Revisa un ejemplo en [Anexo: README de Python](modulo1_tema4_Py_60_anexo.ipynb).

Desde Jupyter/Colab también se pueden instalar paquetes con `!pip` y `!conda` (fíjate que ahora llevan `!` delante.

```
!pip install nombre_paquete
```

Una vez instalados, en cada nueva sesión de Jupyter, hay que importarlos para que sean accesibles.

```
import nombre_paquete
```
