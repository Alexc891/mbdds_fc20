---
title: "MÓDULO: HERRAMIENTAS BIG DATA"
author: "Ferran Carrascosa Mallafrè"
date: "Licenciado en Matemáticas por la Universidad de Barcelona. Data Scientist"
output:
  word_document:
    reference_docx: www/template2.docx
    toc: yes
    toc_depth: 3
  html_document:
    toc: yes
    toc_depth: '6'
    df_print: paged
subtitle: 'Tema: Herramientas de análisis: Programación en Python'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(reticulate)
use_condaenv("mbdds_rpy20")
```

```{=openxml}
<w:p>
  <w:r>
    <w:br w:type="page"/>
  </w:r>
</w:p>
```

# Objetivos específicos

- Realizar operaciones de lectura y escritura de datos con Python.
- Saber escoger la estructura de datos de Python adecuada para cada problema.
- Tener las bases para realizar análisis descriptivo mediante tablas y gráficos en Python.
- Desarrollar pequeñas piezas de código en Python.

# 2. Programación en Python

## 2.1. Introducción

__[Abre en Colab](https://colab.research.google.com/github/griu/mbdds_fc20/blob/master/Python/modulo1_tema4_Py.ipynb)__

Python es una herramienta para la programación de propósito general. 

En los últimos años, se ha convertido en uno de los lenguajes de referencia para el *Data Science*. El motivo es que ha sabido rodearse de un gran ecosistema como [SciPy](https://www.scipy.org/) con librerías (numpy, pandas, scipy...) y herramientas (Jupyter, Spyder,...) orientadas al análisis y a la programación matemática.

Los desarrolladores de Python buscan hacer un lenguaje vivo y atractivo para el programador. Prueba de ello es que su nombre es un tributo a la compañia de humor británica *Monthy Python*.

El núcleo de su filosofía de programación se resume en el "*Zen de Python*", formado por 20 aforismos escritos por Tim Peters, 19 de los cuales se pueden leer más abajo importando `this`. El veinte, dijo Tim Peters que lo diría el creador de Python, Guido van Rossum, pero parece que aún no se ha pronunciado... 

```{python, warning=FALSE}
import this
```

Ser *Pythoniano* o *Pythónico* significa utilizar correctamente el código, es decir, programar con un lenguaje simple y fácil de leer.

## 2.2. Actividad guiada 2

La actividad guiada, que te proponemos, en consonancia con los Pythonianos, es que te diviertas analizando datos relacionados con la saga de Star Wars: Planetas, Naves, Vehículos, Personajes y Especies.

Para ello, contamos con los datos de [SWAPI](https://swapi.dev/), acrónimo de STAR WARS API, que nos da acceso libre a una colección de datos de la saga.

Estos datos se han descargado y preparado expresamente para este curso. Puedes encontrar el código utilizado en el [Anexo: README de Python](modulo1_tema4_Py_60_anexo.ipynb), capítulo "IMPORTAR DATOS DE STARWARS SWAPI".

Para cargar los datos y visualizar su contenido.

```{python}
import pandas as pd
import matplotlib.pyplot as plt
#import seaborn as sns
plt.style.use('seaborn-whitegrid')

entidades = ['planets','starships','vehicles','people','species']
entidades_df = {x: pd.read_pickle('www/' + x + '_df.pkl') for x in entidades}
entidades_count = {k: v.shape for k,v in entidades_df.items()}
entidades_count_df = pd.DataFrame.from_dict(entidades_count, orient='index', columns=['N_Filas', "N_Columnas"])

g = entidades_count_df.plot.bar(alpha=0.75, rot=0)
plt.title("Número de Filas y Columnas en las tablas de Starwars")
#g.title = 'Entidad de Starwars'
for i, (k, row) in enumerate(entidades_count_df.iterrows()):
    g.text(i-0.1, row['N_Filas']+1, row['N_Filas'], color='black', ha="center")
    g.text(i+0.1, row['N_Columnas']+1, row['N_Columnas'], color='black', ha="center")
plt.show()
```

<br>

Vemos que los datos están formados por 5 conjuntos. Por ejemplo, `people`, contienen 82 personajes descritos mediante 16 variables.

Una muestra de los datos de los personajes.

```{python}
entidades_df['people'].head()
```

Observa que hay columnas numéricas como la altura, peso, edad (en años ABY Antes de la Batalla de Yavin). Otras categóricas, como el género del personaje. Incluso columnas en formato de lista, como las películas en las que salió el personaje y los vehículos y naves que condujo...

```
"Yoda habló de otra." 
"La otra de quién habló es tu hermana gemela.» 
― Luke Skywalker y Obi-Wan Kenobi
```

> Te acordabas que Luke y Leia eran gemelos? ¿Sabías que su padre (Anakin, posteriormente Darth Vader tenía 22 años cuando los tuvo?

Podrás analizar todo esto y mucho más, en los datos y así convertirte en el auténtico Jedi que sabemos que llevas dentro.

Consulta la [Documentación de SWAPI](https://swapi.dev/documentation) sobre sus tablas y campos.

*Y que la fuerza te acompañe...*

```{r,child=c("modulo1_tema4_Py_10_elem_bas.Rmd","modulo1_tema4_Py_20_matplotlib.Rmd","modulo1_tema4_Py_30_colec_obj.Rmd","modulo1_tema4_Py_31_numpy.Rmd","modulo1_tema4_Py_32_pandas.Rmd","modulo1_tema4_Py_40_contr_flujo.Rmd","modulo1_tema4_Py_50_gest_dat.Rmd","modulo1_tema4_Py_60_anexo.Rmd")}
```
